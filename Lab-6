"""
Day 6 Activity: Missing Values Practice
Tasks:
1) Load/define a partially observed dataset
2) Normalize missing tokens to NaN
3) Produce missingness summary (per-column %, per-row)
4) Build Version A: drop rows with missing in key cols
5) Build Version B: impute + indicators
6) Compare basic metrics between A and B
"""

import numpy as np
import pandas as pd

# Sample raw dataset (replace or load your own)
raw = {
    "age": [25, "N/A", 40, 33, "?"],
    "income": [50000, 60000, None, "unknown", 80000],
    "churned": [0, 1, 0, 1, 0],
}

df_raw = pd.DataFrame(raw)

# TODO: Normalize custom missing tokens to NaN
custom_missing = ["N/A", "NA", "not reported", "unknown", "?"]
df_norm = df_raw.copy()
df_norm["income"] = df_norm["income"].replace(custom_missing, np.nan)
df_norm["age"] = df_norm["age"].replace(custom_missing, np.nan)
print(df_norm)
print("\nMissing per column:\n", df_norm.isna().sum())


df = df_raw.replace(["N/A", "NA", "not reported", "unknown", "?"], np.nan)

# TODO: Create missing_summary(df) returning per-column and per-row missingness
def missing_summary(df: pd.DataFrame) -> pd.DataFrame:
    total = df.isna().sum()
    pct = (df.isna().mean() * 100).round(1)
    return (pd.DataFrame({"missing_count": total, "missing_percent": pct})
            .sort_values("missing_percent", ascending=False))

summary = missing_summary(df_norm)
df_norm["missing_per_row"] = df_norm.isna().sum(axis=1)
print("\nMissing Summary:\n", summary)

# TODO: Version A: drop rows with missing in key columns (e.g., age, income)
critical_cols = ["income", "age"]

df_drop_any = df_norm.dropna(how="any")          
df_drop_crit = df_norm.dropna(subset=critical_cols)

print("Original:", df_norm.shape, "Drop any:", df_drop_any.shape, "Drop critical:", df_drop_crit.shape)


# TODO: Version B: impute numeric columns + add missing indicators
df_imp = df_raw.copy()
df_imp["income_num"] = pd.to_numeric(df_imp["income"], errors="coerce")

df_imp["age_indicators"] = df_imp["age"].fillna(df_imp["age"].median())
df_imp["age_median_imp"] = df_imp["age"].isna()

 
df_imp["income_indicators"] = df_imp["income"].fillna(df_imp["income"].median())
df_imp["income_median_imp"] = df_imp["income"].isna()

# TODO: Compare basic statistics or a simple model between A and B
print(" stats for Version A:")
print(df_drop_crit.describe())
print(" stats for Version B:")
print(df_imp.describe())
